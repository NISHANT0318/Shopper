{"ast":null,"code":"import React,{createContext,useState,useContext}from\"react\";import all_products from'../Components/Assets/Assets/all_product';import CartItems from\"../Components/CartItems/CartItems\";import{UserContext}from'./userContext';import{useEffect}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const getDefaultCart=()=>{let cart={};for(let index=0;index<all_products.length;index++){cart[all_products[index].id]=0;}return cart;};const ShopContextProvider=props=>{const{user}=useContext(UserContext);const[cartItems,setCartItems]=useState(getDefaultCart());useEffect(()=>{const fetchCart=async()=>{if(user){try{const{data}=await axios.get('/api/cart',{params:{userId:user._id},withCredentials:true});setCartItems(data);}catch(error){console.error('Error fetching cart:',error);}}};fetchCart();},[user]);const saveCart=async cart=>{if(user){try{await axios.post('/api/cart',{userId:user._id,cart},{withCredentials:true});}catch(error){console.error('Error saving cart:',error);}}};const addToCart=itemId=>{setCartItems(prev=>{const newCart={...prev,[itemId]:(prev[itemId]||0)+1};saveCart(newCart);return newCart;});};const removeFromCart=itemId=>{setCartItems(prev=>{const newCart={...prev,[itemId]:(prev[itemId]||0)-1};saveCart(newCart);return newCart;});};const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){let itemInfo=all_products.find(product=>product.id===Number(item));totalAmount+=itemInfo.new_price*cartItems[item];}}console.log(totalAmount);return totalAmount;};const getTotalCartItems=()=>{let totalItems=0;for(const item in cartItems){if(cartItems[item]>0){totalItems+=cartItems[item];}}return totalItems;};const contextValue={all_products,cartItems,addToCart,removeFromCart,getTotalCartAmount,getTotalCartItems};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;","map":{"version":3,"names":["React","createContext","useState","useContext","all_products","CartItems","UserContext","useEffect","axios","jsx","_jsx","ShopContext","getDefaultCart","cart","index","length","id","ShopContextProvider","props","user","cartItems","setCartItems","fetchCart","data","get","params","userId","_id","withCredentials","error","console","saveCart","post","addToCart","itemId","prev","newCart","removeFromCart","getTotalCartAmount","totalAmount","item","itemInfo","find","product","Number","new_price","log","getTotalCartItems","totalItems","contextValue","Provider","value","children"],"sources":["C:/Users/Lenovo/Desktop/Ecom/frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React, { createContext, useState,useContext } from \"react\";\r\nimport all_products from '../Components/Assets/Assets/all_product'\r\nimport CartItems from \"../Components/CartItems/CartItems\";\r\nimport {UserContext} from './userContext'\r\nimport { useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport const ShopContext = createContext(null)\r\n\r\nconst getDefaultCart = () =>{\r\n    let cart = {}\r\n    for (let index = 0; index < all_products.length; index++) {\r\n        \r\n        cart[all_products[index].id] = 0;\r\n        \r\n    }\r\n    return cart\r\n\r\n}\r\n\r\nconst ShopContextProvider = (props) => {\r\n    const { user } = useContext(UserContext);\r\n     const [cartItems,setCartItems] = useState(getDefaultCart())\r\n     useEffect(() => {\r\n        const fetchCart = async () => {\r\n            if (user) {\r\n                try {\r\n                    const { data } = await axios.get('/api/cart', { params: { userId: user._id },withCredentials: true });\r\n                    setCartItems(data);\r\n                } catch (error) {\r\n                    console.error('Error fetching cart:', error);\r\n                }\r\n            }\r\n        };\r\n        fetchCart();\r\n    }, [user]);\r\n\r\n    const saveCart = async (cart) => {\r\n        if (user) {\r\n            try {\r\n                await axios.post('/api/cart', { userId: user._id, cart },{ withCredentials: true });\r\n            } catch (error) {\r\n                console.error('Error saving cart:', error);\r\n            }\r\n        }\r\n    };\r\n\r\n    const addToCart = (itemId) => {\r\n        setCartItems((prev) => {\r\n            const newCart = { ...prev, [itemId]: (prev[itemId] || 0) + 1 };\r\n            saveCart(newCart);\r\n            return newCart;\r\n        });\r\n    };\r\n\r\n    const removeFromCart = (itemId) => {\r\n        setCartItems((prev) => {\r\n            const newCart = { ...prev, [itemId]: (prev[itemId] || 0) - 1 };\r\n            saveCart(newCart);\r\n            return newCart;\r\n        });\r\n    };\r\n\r\n\r\n    const getTotalCartAmount = () =>{\r\n        let totalAmount = 0;\r\n        for (const item in cartItems)\r\n        {\r\n            if(cartItems[item]>0)\r\n            {\r\n                let itemInfo= all_products.find((product)=>product.id === Number(item))\r\n                \r\n                 totalAmount += itemInfo.new_price*cartItems[item]\r\n            }\r\n            \r\n        }\r\n        \r\n        console.log(totalAmount)\r\n        return totalAmount;\r\n        \r\n    }\r\n\r\n\r\n    const  getTotalCartItems = () =>{\r\n        let totalItems = 0;\r\n        for(const item in cartItems)\r\n        {\r\n            if(cartItems[item]>0){\r\n                totalItems += cartItems[item]\r\n            }\r\n        }\r\n        return totalItems\r\n\r\n    }\r\n\r\n   const contextValue = {all_products,cartItems,addToCart,removeFromCart,getTotalCartAmount,getTotalCartItems}\r\n    return(\r\n        <ShopContext.Provider value={contextValue} >\r\n\r\n            {props.children}\r\n\r\n        </ShopContext.Provider>\r\n    )\r\n     \r\n}\r\n\r\nexport default ShopContextProvider;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}